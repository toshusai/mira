(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{235:function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.writeColor=e.writePsd=e.writeSection=e.writeUnicodeStringWithPadding=e.writeUnicodeString=e.writePascalString=e.writeSignature=e.writeZeros=e.writeBytes=e.writeFixedPointPath32=e.writeFixedPoint32=e.writeFloat64=e.writeFloat32=e.writeUint32=e.writeInt32=e.writeUint16=e.writeInt16=e.writeUint8=e.getWriterBufferNoCopy=e.getWriterBuffer=e.createWriter=void 0;var o=r(232),h=r(238),f=r(242);function c(t,e){var r=F(t,1);t.view.setUint8(r,e)}function d(t,e){var r=F(t,2);t.view.setInt16(r,e,!1)}function v(t,e){var r=F(t,2);t.view.setUint16(r,e,!1)}function l(t,e){var r=F(t,4);t.view.setInt32(r,e,!1)}function w(t,e){var r=F(t,4);t.view.setUint32(r,e,!1)}function m(t,e){var r=F(t,8);t.view.setFloat64(r,e,!1)}function y(t,e){e&&(C(t,t.offset+e.length),new Uint8Array(t.buffer).set(e,t.offset),t.offset+=e.length)}function D(t,e){for(var i=0;i<e;i++)c(t,0)}function M(t,e){if(4!==e.length)throw new Error("Invalid signature: '"+e+"'");for(var i=0;i<4;i++)c(t,e.charCodeAt(i))}function I(t,text,e){var r=text.length;c(t,r);for(var i=0;i<r;i++){var code=text.charCodeAt(i);c(t,code<128?code:"?".charCodeAt(0))}for(;++r%e;)c(t,0)}function k(t){void 0===t&&(t=[]);for(var e=0,r=0,n=t;r<n.length;r++){var o=n[r];if(o.canvas||o.imageData){var h=S(o),f=h.width,c=h.height;e=Math.max(e,2*c+2*f*c)}o.children&&(e=Math.max(e,k(o.children)))}return e}function A(t,e,r,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1),o&&w(t,0);var h=t.offset;w(t,0),r();for(var f=t.offset-h-4,d=f;d%e!=0;)c(t,0),d++;n&&(f=d),t.view.setUint32(h,f,!1)}function x(t,e,r,n){for(var f=function(h){var f=h.key;if("Txt2"===f&&n.invalidateTextLayers)return"continue";if("vmsk"===f&&n.psb&&(f="vsms"),h.has(e)){var c=n.psb&&-1!==o.largeAdditionalInfoKeys.indexOf(f);M(t,c?"8B64":"8BIM"),M(t,f),A(t,"Txt2"===f||"luni"===f||"vmsk"===f||"artb"===f||"artd"===f||"vogk"===f||"SoLd"===f||"lnk2"===f||"vscg"===f||"vsms"===f||"GdFl"===f||"lmfx"===f||"lrFX"===f||"cinf"===f||"PlLd"===f||"Anno"===f?4:2,(function(){h.write(t,e,r,n)}),"Txt2"!==f&&"cinf"!==f&&"extn"!==f,c)}},c=0,d=h.infoHandlers;c<d.length;c++){f(d[c])}}function U(t,e){if(e)for(var r=0,h=e;r<h.length;r++){var f=h[r];if(f.children&&f.canvas)throw new Error("Invalid layer, cannot have both 'canvas' and 'children' properties");if(f.children&&f.imageData)throw new Error("Invalid layer, cannot have both 'imageData' and 'children' properties");f.children?(t.push({name:"</Layer group>",sectionDivider:{type:3}}),U(t,f.children),t.push(n({sectionDivider:{type:!1===f.opened?2:1,key:o.fromBlendMode[f.blendMode]||"pass",subType:0}},f))):t.push(n({},f))}}function C(t,e){e>t.buffer.byteLength&&function(t,e){var r=t.buffer.byteLength;do{r*=2}while(e>r);var n=new ArrayBuffer(r),o=new Uint8Array(n),h=new Uint8Array(t.buffer);o.set(h),t.buffer=n,t.view=new DataView(t.buffer)}(t,e)}function F(t,e){var r=t.offset;return C(t,t.offset+=e),r}function P(t){var canvas=o.createCanvas(10,10),e=1;t.width>t.height?(canvas.width=160,canvas.height=Math.floor(t.height*(canvas.width/t.width)),e=canvas.width/t.width):(canvas.height=160,canvas.width=Math.floor(t.width*(canvas.height/t.height)),e=canvas.height/t.height);var r=canvas.getContext("2d");if(r.scale(e,e),t.imageData){var n=o.createCanvas(t.imageData.width,t.imageData.height);n.getContext("2d").putImageData(t.imageData,0,0),r.drawImage(n,0,0)}else t.canvas&&r.drawImage(t.canvas,0,0);return canvas}function S(t){var canvas=t.canvas;return t.imageData||canvas||{width:0,height:0}}function B(t,e,r,n){for(var data=t.data,o=4*(e*t.width+r)+3|0,h=o+4*(n-r)|0,i=o;i<h;i=i+4|0)if(0!==data[i])return!1;return!0}function R(t,e,r,n){for(var data=t.data,o=4*t.width|0,h=r,i=r*o+4*e+3|0;h<n;h++,i=i+o|0)if(0!==data[i])return!1;return!0}e.createWriter=function(t){void 0===t&&(t=4096);var e=new ArrayBuffer(t);return{buffer:e,view:new DataView(e),offset:0}},e.getWriterBuffer=function(t){return t.buffer.slice(0,t.offset)},e.getWriterBufferNoCopy=function(t){return new Uint8Array(t.buffer,0,t.offset)},e.writeUint8=c,e.writeInt16=d,e.writeUint16=v,e.writeInt32=l,e.writeUint32=w,e.writeFloat32=function(t,e){var r=F(t,4);t.view.setFloat32(r,e,!1)},e.writeFloat64=m,e.writeFixedPoint32=function(t,e){l(t,65536*e)},e.writeFixedPointPath32=function(t,e){l(t,e*(1<<24))},e.writeBytes=y,e.writeZeros=D,e.writeSignature=M,e.writePascalString=I,e.writeUnicodeString=function(t,text){w(t,text.length);for(var i=0;i<text.length;i++)v(t,text.charCodeAt(i))},e.writeUnicodeStringWithPadding=function(t,text){w(t,text.length+1);for(var i=0;i<text.length;i++)v(t,text.charCodeAt(i));v(t,0)},e.writeSection=A,e.writePsd=function(t,e,r){if(void 0===r&&(r={}),!(+e.width>0&&+e.height>0))throw new Error("Invalid document size");if((e.width>3e4||e.height>3e4)&&!r.psb)throw new Error("Document size is too large (max is 30000x30000, use PSB format instead)");var C=e.imageResources||{},F=n(n({},r),{layerIds:[]});F.generateThumbnail&&(C=n(n({},C),{thumbnail:P(e)}));var E=e.imageData;if(!E&&e.canvas&&(E=e.canvas.getContext("2d").getImageData(0,0,e.canvas.width,e.canvas.height)),E&&(e.width!==E.width||e.height!==E.height))throw new Error("Document canvas must have the same size as document");var W=!!E&&o.hasAlpha(E),_=Math.max(k(e.children),8*e.width*e.height+2*e.height),L=new Uint8Array(_);M(t,"8BPS"),v(t,r.psb?2:1),D(t,6),v(t,W?4:3),w(t,e.height),w(t,e.width),v(t,8),v(t,3),A(t,1,(function(){})),A(t,1,(function(){for(var e=function(e){e.has(C)&&(M(t,"8BIM"),v(t,e.key),I(t,"",2),A(t,2,(function(){return e.write(t,C)})))},r=0,n=f.resourceHandlers;r<n.length;r++){e(n[r])}})),A(t,2,(function(){!function(t,e,r,n,f){A(e,4,(function(){var k,C=[];U(C,r.children),C.length||C.push({}),d(e,n?-C.length:C.length);for(var F=C.map((function(e,i){return function(t,e,r,n){var h=function(t,e,r,n){var h,f=e.top,c=void 0===f?0:f,d=e.left,v=void 0===d?0:d,l=e.right,w=void 0===l?0:l,m=e.bottom,y=void 0===m?0:m,D=[{channelId:-1,compression:0,buffer:void 0,length:2},{channelId:0,compression:0,buffer:void 0,length:2},{channelId:1,compression:0,buffer:void 0,length:2},{channelId:2,compression:0,buffer:void 0,length:2}],M=S(e),I=M.width,k=M.height;if(!e.canvas&&!e.imageData||!I||!k)return{layer:e,top:c,left:v,right:w=v,bottom:y=c,channels:D};w=v+I,y=c+k;var data=e.imageData||e.canvas.getContext("2d").getImageData(0,0,I,k);if(n.trimImageData){var A=function(data){var t=0,e=0,r=data.width,n=data.height;for(;t<n&&B(data,t,e,r);)t++;for(;n>t&&B(data,n-1,e,r);)n--;for(;e<r&&R(data,e,t,n);)e++;for(;r>e&&R(data,r-1,t,n);)r--;return{top:t,left:e,right:r,bottom:n}}(data);if(0!==A.left||0!==A.top||A.right!==data.width||A.bottom!==data.height){if(v+=A.left,c+=A.top,w-=data.width-A.right,y-=data.height-A.bottom,k=y-c,!(I=w-v)||!k)return{layer:e,top:c,left:v,right:w,bottom:y,channels:D};data=e.imageData?function(data,t,e,r,n){for(var h=o.createImageData(r,n),f=data.data,c=h.data,d=0;d<n;d++)for(var v=0;v<r;v++){var l=4*(v+t+(d+e)*r),w=4*(v+d*r);c[w]=f[l],c[w+1]=f[l+1],c[w+2]=f[l+2],c[w+3]=f[l+3]}return h}(data,A.left,A.top,I,k):e.canvas.getContext("2d").getImageData(A.left,A.top,I,k)}}var x=[0,1,2];(!r||n.noBackground||e.mask||o.hasAlpha(data)||o.RAW_IMAGE_DATA&&(null===(h=e.imageDataRaw)||void 0===h?void 0:h[-1]))&&x.unshift(-1);return D=x.map((function(r){var h=o.offsetForChannel(r),f=o.writeDataRLE(t,data,I,k,[h],!!n.psb);return o.RAW_IMAGE_DATA&&e.imageDataRaw&&(f=e.imageDataRaw[r]),{channelId:r,compression:1,buffer:f,length:2+f.length}})),{layer:e,top:c,left:v,right:w,bottom:y,channels:D}}(t,e,r,n),mask=e.mask;if(mask){var f=mask.top,c=void 0===f?0:f,d=mask.left,v=void 0===d?0:d,l=mask.right,w=void 0===l?0:l,m=mask.bottom,y=void 0===m?0:m,D=S(mask),M=D.width,I=D.height,k=mask.imageData;if(!k&&mask.canvas&&M&&I&&(k=mask.canvas.getContext("2d").getImageData(0,0,M,I)),M&&I&&k){w=v+M,y=c+I;var A=o.writeDataRLE(t,k,M,I,[0],!!n.psb);o.RAW_IMAGE_DATA&&e.maskDataRaw&&(A=e.maskDataRaw),h.mask={top:c,left:v,right:w,bottom:y},h.channels.push({channelId:-2,compression:1,buffer:A,length:2+A.length})}else h.mask={top:0,left:0,right:0,bottom:0},h.channels.push({channelId:-2,compression:0,buffer:new Uint8Array(0),length:0})}return h}(t,e,0===i,f)})),P=function(t){var n=t.layer,y=t.top,U=t.left,C=t.bottom,F=t.right,P=t.channels;l(e,y),l(e,U),l(e,C),l(e,F),v(e,P.length);for(var S=0,B=P;S<B.length;S++){var R=B[S];d(e,R.channelId),f.psb&&w(e,0),w(e,R.length)}M(e,"8BIM"),M(e,o.fromBlendMode[n.blendMode]||"norm"),c(e,Math.round(255*o.clamp(null!==(k=n.opacity)&&void 0!==k?k:1,0,1))),c(e,n.clipping?1:0);var E=8;n.transparencyProtected&&(E|=1),n.hidden&&(E|=2),(n.vectorMask||n.sectionDivider&&0!==n.sectionDivider.type)&&(E|=16),n.effects&&h.hasMultiEffects(n.effects)&&(E|=32),c(e,E),c(e,0),A(e,1,(function(){!function(t,e,r){var mask=e.mask;A(t,1,(function(){if(mask){var e=r.mask||{};l(t,e.top),l(t,e.left),l(t,e.bottom),l(t,e.right),c(t,mask.defaultColor);var n=0;void 0!==mask.userMaskDensity&&(n|=1),void 0!==mask.userMaskFeather&&(n|=2),void 0!==mask.vectorMaskDensity&&(n|=4),void 0!==mask.vectorMaskFeather&&(n|=8);var o=0;mask.disabled&&(o|=2),mask.positionRelativeToLayer&&(o|=1),mask.fromVectorData&&(o|=8),n&&(o|=16),c(t,o),n&&(c(t,n),void 0!==mask.userMaskDensity&&c(t,Math.round(255*mask.userMaskDensity)),void 0!==mask.userMaskFeather&&m(t,mask.userMaskFeather),void 0!==mask.vectorMaskDensity&&c(t,Math.round(255*mask.vectorMaskDensity)),void 0!==mask.vectorMaskFeather&&m(t,mask.vectorMaskFeather)),D(t,2)}}))}(e,n,t),function(t,e){A(t,1,(function(){w(t,65535),w(t,65535);for(var r=e.channels||0,i=0;i<r;i++)w(t,65535),w(t,65535)}))}(e,r),I(e,n.name||"",4),x(e,n,r,f)}))},E=0,W=F;E<W.length;E++){P(W[E])}for(var _=0,L=F;_<L.length;_++)for(var T=0,G=L[_].channels;T<G.length;T++){var O=G[T];v(e,O.compression),O.buffer&&y(e,O.buffer)}}),!0,f.psb)}(L,t,e,W,F),function(t,e){A(t,1,(function(){e&&(v(t,e.overlayColorSpace),v(t,e.colorSpace1),v(t,e.colorSpace2),v(t,e.colorSpace3),v(t,e.colorSpace4),v(t,255*e.opacity),c(t,e.kind),D(t,3))}))}(t,e.globalLayerMaskInfo),x(t,e,e,F)}),void 0,!!F.psb);var T=W?[0,1,2,3]:[0,1,2],data=E||{data:new Uint8Array(4*e.width*e.height),width:e.width,height:e.height};v(t,1),o.RAW_IMAGE_DATA&&e.imageDataRaw?(console.log("writing raw image data"),y(t,e.imageDataRaw)):y(t,o.writeDataRLE(L,data,e.width,e.height,T,!!r.psb))},e.writeColor=function(t,e){e?"r"in e?(v(t,0),v(t,Math.round(257*e.r)),v(t,Math.round(257*e.g)),v(t,Math.round(257*e.b)),v(t,0)):"l"in e?(v(t,7),d(t,Math.round(1e4*e.l)),d(t,Math.round(e.a<0?12800*e.a:12700*e.a)),d(t,Math.round(e.b<0?12800*e.b:12700*e.b)),v(t,0)):"h"in e?(v(t,1),v(t,Math.round(65535*e.h)),v(t,Math.round(65535*e.s)),v(t,Math.round(65535*e.b)),v(t,0)):"c"in e?(v(t,2),v(t,Math.round(257*e.c)),v(t,Math.round(257*e.m)),v(t,Math.round(257*e.y)),v(t,Math.round(257*e.k))):(v(t,8),v(t,Math.round(1e4*e.k/255)),D(t,6)):(v(t,0),D(t,8))}}}]);