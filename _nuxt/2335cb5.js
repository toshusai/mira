(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{241:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.hasMultiEffects=t.readVectorMask=t.booleanOperations=t.readBezierKnot=t.infoHandlersMap=t.infoHandlers=void 0;var o=r(234),l=r(268),d=r(232),c=r(233),v=r(235),f=r(242),w=r(270),y=r(271);function h(e,r,n,o){var l={key:e,has:r,read:n,write:o};t.infoHandlers.push(l),t.infoHandlersMap[l.key]=l}function m(e,r){t.infoHandlersMap[e]=t.infoHandlersMap[r]}function k(e){return function(t){return void 0!==t[e]}}function S(e){if(c.readUint32(e))throw new Error("Resource size above 4 GB limit at "+e.offset.toString(16));return c.readUint32(e)}function U(e,t){v.writeUint32(e,0),v.writeUint32(e,t)}function I(e,t,r){var n=c.readFixedPointPath32(e)*r,o=c.readFixedPointPath32(e)*t,l=c.readFixedPointPath32(e)*r,d=c.readFixedPointPath32(e)*t,v=c.readFixedPointPath32(e)*r;return[o,n,d,l,c.readFixedPointPath32(e)*t,v]}function F(e,t,r,n){v.writeFixedPointPath32(e,t[1]/n),v.writeFixedPointPath32(e,t[0]/r),v.writeFixedPointPath32(e,t[3]/n),v.writeFixedPointPath32(e,t[2]/r),v.writeFixedPointPath32(e,t[5]/n),v.writeFixedPointPath32(e,t[4]/r)}function P(e,r,n,o,l){for(var d=e.offset+l,v=r.paths,path=void 0;d-e.offset>=26;){var f=c.readUint16(e);switch(f){case 0:case 3:c.readUint16(e);var w=c.readInt16(e);c.readUint16(e),c.skipBytes(e,18),path={open:3===f,operation:-1===w?"combine":t.booleanOperations[w],knots:[]},v.push(path);break;case 1:case 2:case 4:case 5:path.knots.push({linked:1===f||4===f,points:I(e,n,o)});break;case 6:c.skipBytes(e,24);break;case 7:var y=c.readFixedPointPath32(e),h=c.readFixedPointPath32(e),m=c.readFixedPointPath32(e),k=c.readFixedPointPath32(e),S=c.readFixedPointPath32(e);c.skipBytes(e,4),r.clipboard={top:y,left:h,bottom:m,right:k,resolution:S};break;case 8:r.fillStartsWithAllPixels=!!c.readUint16(e),c.skipBytes(e,22);break;default:throw new Error("Invalid vmsk section")}}return v}t.infoHandlers=[],t.infoHandlersMap={},h("TySh",k("text"),(function(e,t,r){if(1!==c.readInt16(e))throw new Error("Invalid TySh version");for(var o=[],i=0;i<6;i++)o.push(c.readFloat64(e));if(50!==c.readInt16(e))throw new Error("Invalid TySh text version");var text=f.readVersionAndDescriptor(e);if(1!==c.readInt16(e))throw new Error("Invalid TySh warp version");var l=f.readVersionAndDescriptor(e);if(t.text={transform:o,left:c.readFloat32(e),top:c.readFloat32(e),right:c.readFloat32(e),bottom:c.readFloat32(e),text:text["Txt "].replace(/\r/g,"\n"),index:text.TextIndex||0,gridding:f.textGridding.decode(text.textGridding),antiAlias:f.Annt.decode(text.AntA),orientation:f.Ornt.decode(text.Ornt),warp:{style:f.warpStyle.decode(l.warpStyle),value:l.warpValue||0,perspective:l.warpPerspective||0,perspectiveOther:l.warpPerspectiveOther||0,rotate:f.Ornt.decode(l.warpRotate)}},text.EngineData){var d=y.decodeEngineData(w.parseEngineData(text.EngineData));t.text=n(n({},t.text),d)}c.skipBytes(e,r())}),(function(e,t){var text=t.text,r=text.warp||{},n=text.transform||[1,0,0,1,0,0],o={"Txt ":(text.text||"").replace(/\r?\n/g,"\r"),textGridding:f.textGridding.encode(text.gridding),Ornt:f.Ornt.encode(text.orientation),AntA:f.Annt.encode(text.antiAlias),TextIndex:text.index||0,EngineData:w.serializeEngineData(y.encodeEngineData(text))};v.writeInt16(e,1);for(var i=0;i<6;i++)v.writeFloat64(e,n[i]);v.writeInt16(e,50),f.writeVersionAndDescriptor(e,"","TxLr",o),v.writeInt16(e,1),f.writeVersionAndDescriptor(e,"","warp",C(r)),v.writeFloat32(e,text.left),v.writeFloat32(e,text.top),v.writeFloat32(e,text.right),v.writeFloat32(e,text.bottom)})),h("SoCo",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"color"===e.vectorFill.type}),(function(e,t){var r=f.readVersionAndDescriptor(e);t.vectorFill=ae(r)}),(function(e,t){var r=de(t.vectorFill).descriptor;f.writeVersionAndDescriptor(e,"","null",r)})),h("GdFl",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&("solid"===e.vectorFill.type||"noise"===e.vectorFill.type)}),(function(e,t,r){var n=f.readVersionAndDescriptor(e);t.vectorFill=ae(n),c.skipBytes(e,r())}),(function(e,t){var r=de(t.vectorFill).descriptor;f.writeVersionAndDescriptor(e,"","null",r)})),h("PtFl",(function(e){return void 0!==e.vectorFill&&void 0===e.vectorStroke&&"pattern"===e.vectorFill.type}),(function(e,t){var r=f.readVersionAndDescriptor(e);t.vectorFill=ae(r)}),(function(e,t){var r=de(t.vectorFill).descriptor;f.writeVersionAndDescriptor(e,"","null",r)})),h("vscg",(function(e){return void 0!==e.vectorFill&&void 0!==e.vectorStroke}),(function(e,t,r){c.readSignature(e);var desc=f.readVersionAndDescriptor(e);t.vectorFill=ae(desc),c.skipBytes(e,r())}),(function(e,t){var r=de(t.vectorFill),n=r.descriptor,o=r.key;v.writeSignature(e,o),f.writeVersionAndDescriptor(e,"","null",n)})),t.readBezierKnot=I,t.booleanOperations=["exclude","combine","subtract","intersect"],t.readVectorMask=P,h("vmsk",k("vectorMask"),(function(e,t,r,n){var o=n.width,l=n.height;if(3!==c.readUint32(e))throw new Error("Invalid vmsk version");t.vectorMask={paths:[]};var d=t.vectorMask,v=c.readUint32(e);d.invert=0!=(1&v),d.notLink=0!=(2&v),d.disable=0!=(4&v),P(e,d,o,l,r()),c.skipBytes(e,r())}),(function(e,r,n){var o=n.width,l=n.height,d=r.vectorMask,c=(d.invert?1:0)|(d.notLink?2:0)|(d.disable?4:0);v.writeUint32(e,3),v.writeUint32(e,c),v.writeUint16(e,6),v.writeZeros(e,24);var f=d.clipboard;f&&(v.writeUint16(e,7),v.writeFixedPointPath32(e,f.top),v.writeFixedPointPath32(e,f.left),v.writeFixedPointPath32(e,f.bottom),v.writeFixedPointPath32(e,f.right),v.writeFixedPointPath32(e,f.resolution),v.writeZeros(e,4)),void 0!==d.fillStartsWithAllPixels&&(v.writeUint16(e,8),v.writeUint16(e,d.fillStartsWithAllPixels?1:0),v.writeZeros(e,22));for(var w=0,y=d.paths;w<y.length;w++){var path=y[w];v.writeUint16(e,path.open?3:0),v.writeUint16(e,path.knots.length),v.writeUint16(e,Math.abs(t.booleanOperations.indexOf(path.operation))),v.writeUint16(e,1),v.writeZeros(e,18);for(var h=path.open?4:1,m=path.open?5:2,k=0,S=path.knots;k<S.length;k++){var U=S[k],I=U.linked,P=U.points;v.writeUint16(e,I?h:m),F(e,P,o,l)}}})),m("vsms","vmsk"),h("vogk",k("vectorOrigination"),(function(e,t,r){if(1!==c.readInt32(e))throw new Error("Invalid vogk version");var desc=f.readVersionAndDescriptor(e);t.vectorOrigination={keyDescriptorList:[]};for(var n=0,o=desc.keyDescriptorList;n<o.length;n++){var i=o[n],l={};null!=i.keyShapeInvalidated&&(l.keyShapeInvalidated=i.keyShapeInvalidated),null!=i.keyOriginType&&(l.keyOriginType=i.keyOriginType),null!=i.keyOriginResolution&&(l.keyOriginResolution=i.keyOriginResolution),i.keyOriginShapeBBox&&(l.keyOriginShapeBoundingBox={top:f.parseUnits(i.keyOriginShapeBBox["Top "]),left:f.parseUnits(i.keyOriginShapeBBox.Left),bottom:f.parseUnits(i.keyOriginShapeBBox.Btom),right:f.parseUnits(i.keyOriginShapeBBox.Rght)});var d=i.keyOriginRRectRadii;d&&(l.keyOriginRRectRadii={topRight:f.parseUnits(d.topRight),topLeft:f.parseUnits(d.topLeft),bottomLeft:f.parseUnits(d.bottomLeft),bottomRight:f.parseUnits(d.bottomRight)});var v=i.keyOriginBoxCorners;v&&(l.keyOriginBoxCorners=[{x:v.rectangleCornerA.Hrzn,y:v.rectangleCornerA.Vrtc},{x:v.rectangleCornerB.Hrzn,y:v.rectangleCornerB.Vrtc},{x:v.rectangleCornerC.Hrzn,y:v.rectangleCornerC.Vrtc},{x:v.rectangleCornerD.Hrzn,y:v.rectangleCornerD.Vrtc}]);var w=i.Trnf;w&&(l.transform=[w.xx,w.xy,w.xy,w.yy,w.tx,w.ty]),t.vectorOrigination.keyDescriptorList.push(l)}c.skipBytes(e,r())}),(function(e,t){for(var r,n,o=t.vectorOrigination,desc={keyDescriptorList:[]},i=0;i<o.keyDescriptorList.length;i++){var l=o.keyDescriptorList[i];if(l.keyShapeInvalidated)desc.keyDescriptorList.push({keyShapeInvalidated:!0,keyOriginIndex:i});else{desc.keyDescriptorList.push({keyOriginType:null!==(r=l.keyOriginType)&&void 0!==r?r:4,keyOriginResolution:null!==(n=l.keyOriginResolution)&&void 0!==n?n:72});var d=desc.keyDescriptorList[desc.keyDescriptorList.length-1],c=l.keyOriginRRectRadii;c&&(d.keyOriginRRectRadii={unitValueQuadVersion:1,topRight:f.unitsValue(c.topRight,"topRight"),topLeft:f.unitsValue(c.topLeft,"topLeft"),bottomLeft:f.unitsValue(c.bottomLeft,"bottomLeft"),bottomRight:f.unitsValue(c.bottomRight,"bottomRight")});var w=l.keyOriginShapeBoundingBox;w&&(d.keyOriginShapeBBox={unitValueQuadVersion:1,"Top ":f.unitsValue(w.top,"top"),Left:f.unitsValue(w.left,"left"),Btom:f.unitsValue(w.bottom,"bottom"),Rght:f.unitsValue(w.right,"right")});var y=l.keyOriginBoxCorners;y&&4===y.length&&(d.keyOriginBoxCorners={rectangleCornerA:{Hrzn:y[0].x,Vrtc:y[0].y},rectangleCornerB:{Hrzn:y[1].x,Vrtc:y[1].y},rectangleCornerC:{Hrzn:y[2].x,Vrtc:y[2].y},rectangleCornerD:{Hrzn:y[3].x,Vrtc:y[3].y}});var h=l.transform;h&&6===h.length&&(d.Trnf={xx:h[0],xy:h[1],yx:h[2],yy:h[3],tx:h[4],ty:h[5]}),d.keyOriginIndex=i}}v.writeInt32(e,1),f.writeVersionAndDescriptor(e,"","null",desc)})),h("lmfx",(function(e){return void 0!==e.effects&&te(e.effects)}),(function(e,t,r,n,o){if(0!==c.readUint32(e))throw new Error("Invalid lmfx version");var desc=f.readVersionAndDescriptor(e);t.effects=$(desc,!!o.logMissingFeatures),c.skipBytes(e,r())}),(function(e,t,r,n){var desc=ee(t.effects,!!n.logMissingFeatures,!0);v.writeUint32(e,0),f.writeVersionAndDescriptor(e,"","null",desc)})),h("lrFX",k("effects"),(function(e,t,r){t.effects||(t.effects=l.readEffects(e)),c.skipBytes(e,r())}),(function(e,t){l.writeEffects(e,t.effects)})),h("luni",k("name"),(function(e,t,r){t.name=c.readUnicodeString(e),c.skipBytes(e,r())}),(function(e,t){v.writeUnicodeString(e,t.name)})),h("lnsr",k("nameSource"),(function(e,t){return t.nameSource=c.readSignature(e)}),(function(e,t){return v.writeSignature(e,t.nameSource)})),h("lyid",k("id"),(function(e,t){return t.id=c.readUint32(e)}),(function(e,t,r,n){for(var o=t.id;-1!==n.layerIds.indexOf(o);)o+=100;v.writeUint32(e,o),n.layerIds.push(o)})),h("lsct",k("sectionDivider"),(function(e,t,r){t.sectionDivider={type:c.readUint32(e)},r()&&(c.checkSignature(e,"8BIM"),t.sectionDivider.key=c.readSignature(e)),r()&&(t.sectionDivider.subType=c.readUint32(e))}),(function(e,t){v.writeUint32(e,t.sectionDivider.type),t.sectionDivider.key&&(v.writeSignature(e,"8BIM"),v.writeSignature(e,t.sectionDivider.key),void 0!==t.sectionDivider.subType&&v.writeUint32(e,t.sectionDivider.subType))})),m("lsdk","lsct"),h("clbl",k("blendClippendElements"),(function(e,t){t.blendClippendElements=!!c.readUint8(e),c.skipBytes(e,3)}),(function(e,t){v.writeUint8(e,t.blendClippendElements?1:0),v.writeZeros(e,3)})),h("infx",k("blendInteriorElements"),(function(e,t){t.blendInteriorElements=!!c.readUint8(e),c.skipBytes(e,3)}),(function(e,t){v.writeUint8(e,t.blendInteriorElements?1:0),v.writeZeros(e,3)})),h("knko",k("knockout"),(function(e,t){t.knockout=!!c.readUint8(e),c.skipBytes(e,3)}),(function(e,t){v.writeUint8(e,t.knockout?1:0),v.writeZeros(e,3)})),h("lspf",k("protected"),(function(e,t){var r=c.readUint32(e);t.protected={transparency:0!=(1&r),composite:0!=(2&r),position:0!=(4&r)},8&r&&(t.protected.artboards=!0)}),(function(e,t){var r=(t.protected.transparency?1:0)|(t.protected.composite?2:0)|(t.protected.position?4:0)|(t.protected.artboards?8:0);v.writeUint32(e,r)})),h("lclr",k("layerColor"),(function(e,t){var r=c.readUint16(e);c.skipBytes(e,6),t.layerColor=d.layerColors[r]}),(function(e,t){var r=d.layerColors.indexOf(t.layerColor);v.writeUint16(e,-1===r?0:r),v.writeZeros(e,6)})),h("shmd",k("timestamp"),(function(e,t,r,n,o){for(var l=c.readUint32(e),d=function(i){c.checkSignature(e,"8BIM");var r=c.readSignature(e);c.readUint8(e),c.skipBytes(e,3),c.readSection(e,1,(function(n){if("cust"===r)void 0!==(desc=f.readVersionAndDescriptor(e)).layerTime&&(t.timestamp=desc.layerTime);else if("mlst"===r){var desc=f.readVersionAndDescriptor(e);o.logDevFeatures&&console.log("mlst",desc)}else if("mdyn"===r){var l=c.readUint16(e),d=c.readUint8(e),v=c.readUint8(e),w=0!=(1&v),y=0!=(2&v),h=0!=(4&v);o.logDevFeatures&&console.log("mdyn","unknown:",l,"propagate:",d,"flags:",v,{unifyLayerPosition:w,unifyLayerStyle:y,unifyLayerVisibility:h})}else o.logDevFeatures&&console.log("Unhandled metadata",r);c.skipBytes(e,n())}))},i=0;i<l;i++)d();c.skipBytes(e,r())}),(function(e,t){var desc={layerTime:t.timestamp};v.writeUint32(e,1),v.writeSignature(e,"8BIM"),v.writeSignature(e,"cust"),v.writeUint8(e,0),v.writeZeros(e,3),v.writeSection(e,2,(function(){return f.writeVersionAndDescriptor(e,"","metadata",desc)}),!0)})),h("vstk",k("vectorStroke"),(function(e,t,r){var desc=f.readVersionAndDescriptor(e);t.vectorStroke={strokeEnabled:desc.strokeEnabled,fillEnabled:desc.fillEnabled,lineWidth:f.parseUnits(desc.strokeStyleLineWidth),lineDashOffset:f.parseUnits(desc.strokeStyleLineDashOffset),miterLimit:desc.strokeStyleMiterLimit,lineCapType:f.strokeStyleLineCapType.decode(desc.strokeStyleLineCapType),lineJoinType:f.strokeStyleLineJoinType.decode(desc.strokeStyleLineJoinType),lineAlignment:f.strokeStyleLineAlignment.decode(desc.strokeStyleLineAlignment),scaleLock:desc.strokeStyleScaleLock,strokeAdjust:desc.strokeStyleStrokeAdjust,lineDashSet:desc.strokeStyleLineDashSet.map(f.parseUnits),blendMode:f.BlnM.decode(desc.strokeStyleBlendMode),opacity:f.parsePercent(desc.strokeStyleOpacity),content:ae(desc.strokeStyleContent),resolution:desc.strokeStyleResolution},c.skipBytes(e,r())}),(function(e,t){var r,n,o,l=t.vectorStroke,d={strokeStyleVersion:2,strokeEnabled:!!l.strokeEnabled,fillEnabled:!!l.fillEnabled,strokeStyleLineWidth:l.lineWidth||{value:3,units:"Points"},strokeStyleLineDashOffset:l.lineDashOffset||{value:0,units:"Points"},strokeStyleMiterLimit:null!==(r=l.miterLimit)&&void 0!==r?r:100,strokeStyleLineCapType:f.strokeStyleLineCapType.encode(l.lineCapType),strokeStyleLineJoinType:f.strokeStyleLineJoinType.encode(l.lineJoinType),strokeStyleLineAlignment:f.strokeStyleLineAlignment.encode(l.lineAlignment),strokeStyleScaleLock:!!l.scaleLock,strokeStyleStrokeAdjust:!!l.strokeAdjust,strokeStyleLineDashSet:l.lineDashSet||[],strokeStyleBlendMode:f.BlnM.encode(l.blendMode),strokeStyleOpacity:f.unitsPercent(null!==(n=l.opacity)&&void 0!==n?n:1),strokeStyleContent:de(l.content||{type:"color",color:{r:0,g:0,b:0}}).descriptor,strokeStyleResolution:null!==(o=l.resolution)&&void 0!==o?o:72};f.writeVersionAndDescriptor(e,"","strokeStyle",d)})),h("artb",k("artboard"),(function(e,t,r){var desc=f.readVersionAndDescriptor(e),rect=desc.artboardRect;t.artboard={rect:{top:rect["Top "],left:rect.Left,bottom:rect.Btom,right:rect.Rght},guideIndices:desc.guideIndeces,presetName:desc.artboardPresetName,color:ce(desc["Clr "]),backgroundType:desc.artboardBackgroundType},c.skipBytes(e,r())}),(function(e,t){var r,n=t.artboard,rect=n.rect,desc={artboardRect:{"Top ":rect.top,Left:rect.left,Btom:rect.bottom,Rght:rect.right},guideIndeces:n.guideIndices||[],artboardPresetName:n.presetName||"","Clr ":ue(n.color),artboardBackgroundType:null!==(r=n.backgroundType)&&void 0!==r?r:1};f.writeVersionAndDescriptor(e,"","artboard",desc)})),h("sn2P",k("usingAlignedRendering"),(function(e,t){return t.usingAlignedRendering=!!c.readUint32(e)}),(function(e,t){return v.writeUint32(e,t.usingAlignedRendering?1:0)}));var O=["unknown","vector","raster","image stack"];function D(e){var t,r,n,o,l,d,c={style:f.warpStyle.decode(e.warpStyle),value:e.warpValue||0,perspective:e.warpPerspective||0,perspectiveOther:e.warpPerspectiveOther||0,rotate:f.Ornt.decode(e.warpRotate),bounds:e.bounds&&{top:f.parseUnitsOrNumber(e.bounds["Top "]),left:f.parseUnitsOrNumber(e.bounds.Left),bottom:f.parseUnitsOrNumber(e.bounds.Btom),right:f.parseUnitsOrNumber(e.bounds.Rght)},uOrder:e.uOrder,vOrder:e.vOrder};null==e.deformNumRows&&null==e.deformNumCols||(c.deformNumRows=e.deformNumRows,c.deformNumCols=e.deformNumCols);var v=e.customEnvelopeWarp;if(v){c.customEnvelopeWarp={meshPoints:[]};for(var w=(null===(t=v.meshPoints.find((function(i){return"Hrzn"===i.type})))||void 0===t?void 0:t.values)||[],y=(null===(r=v.meshPoints.find((function(i){return"Vrtc"===i.type})))||void 0===r?void 0:r.values)||[],i=0;i<w.length;i++)c.customEnvelopeWarp.meshPoints.push({x:w[i],y:y[i]});(v.quiltSliceX||v.quiltSliceY)&&(c.customEnvelopeWarp.quiltSliceX=(null===(o=null===(n=v.quiltSliceX)||void 0===n?void 0:n[0])||void 0===o?void 0:o.values)||[],c.customEnvelopeWarp.quiltSliceY=(null===(d=null===(l=v.quiltSliceY)||void 0===l?void 0:l[0])||void 0===d?void 0:d.values)||[])}return c}function x(e){var t,r;return null!=e.deformNumCols||null!=e.deformNumRows||(null===(t=e.customEnvelopeWarp)||void 0===t?void 0:t.quiltSliceX)||(null===(r=e.customEnvelopeWarp)||void 0===r?void 0:r.quiltSliceY)}function C(e){var t=e.bounds,desc={warpStyle:f.warpStyle.encode(e.style),warpValue:e.value||0,warpPerspective:e.perspective||0,warpPerspectiveOther:e.perspectiveOther||0,warpRotate:f.Ornt.encode(e.rotate),bounds:{"Top ":f.unitsValue(t&&t.top||{units:"Pixels",value:0},"bounds.top"),Left:f.unitsValue(t&&t.left||{units:"Pixels",value:0},"bounds.left"),Btom:f.unitsValue(t&&t.bottom||{units:"Pixels",value:0},"bounds.bottom"),Rght:f.unitsValue(t&&t.right||{units:"Pixels",value:0},"bounds.right")},uOrder:e.uOrder||0,vOrder:e.vOrder||0},r=x(e);r&&((o=desc).deformNumRows=e.deformNumRows||0,o.deformNumCols=e.deformNumCols||0);var n=e.customEnvelopeWarp;if(n){var o,l=n.meshPoints||[];if(r)(o=desc).customEnvelopeWarp={quiltSliceX:[{type:"quiltSliceX",values:n.quiltSliceX||[]}],quiltSliceY:[{type:"quiltSliceY",values:n.quiltSliceY||[]}],meshPoints:[{type:"Hrzn",values:l.map((function(p){return p.x}))},{type:"Vrtc",values:l.map((function(p){return p.y}))}]};else desc.customEnvelopeWarp={meshPoints:[{type:"Hrzn",values:l.map((function(p){return p.x}))},{type:"Vrtc",values:l.map((function(p){return p.y}))}]}}return desc}function A(e){return{top:c.readInt32(e),left:c.readInt32(e),bottom:c.readInt32(e),right:c.readInt32(e)}}function L(e,rect){v.writeInt32(e,rect.top),v.writeInt32(e,rect.left),v.writeInt32(e,rect.bottom),v.writeInt32(e,rect.right)}function B(e){return function(t){return!!t.adjustment&&t.adjustment.type===e}}function E(e){return{shadowInput:c.readInt16(e),highlightInput:c.readInt16(e),shadowOutput:c.readInt16(e),highlightOutput:c.readInt16(e),midtoneInput:c.readInt16(e)/100}}function T(e,t){v.writeInt16(e,t.shadowInput),v.writeInt16(e,t.highlightInput),v.writeInt16(e,t.shadowOutput),v.writeInt16(e,t.highlightOutput),v.writeInt16(e,Math.round(100*t.midtoneInput))}function M(e){for(var t=c.readUint16(e),r=[],n=0;n<t;n++){var output=c.readInt16(e),input=c.readInt16(e);r.push({input:input,output:output})}return r}function V(e,t){v.writeUint16(e,t.length);for(var r=0,n=t;r<n.length;r++){var o=n[r];v.writeUint16(e,o.output),v.writeUint16(e,o.input)}}function N(e){return{a:c.readInt16(e),b:c.readInt16(e),c:c.readInt16(e),d:c.readInt16(e),hue:c.readInt16(e),saturation:c.readInt16(e),lightness:c.readInt16(e)}}function R(e,t){var r=t||{};v.writeInt16(e,r.a||0),v.writeInt16(e,r.b||0),v.writeInt16(e,r.c||0),v.writeInt16(e,r.d||0),v.writeInt16(e,r.hue||0),v.writeInt16(e,r.saturation||0),v.writeInt16(e,r.lightness||0)}function G(e){return{cyanRed:c.readInt16(e),magentaGreen:c.readInt16(e),yellowBlue:c.readInt16(e)}}function j(e,t){v.writeInt16(e,t.cyanRed||0),v.writeInt16(e,t.magentaGreen||0),v.writeInt16(e,t.yellowBlue||0)}function z(e){var t=c.readInt16(e),r=c.readInt16(e),n=c.readInt16(e);return c.skipBytes(e,2),{red:t,green:r,blue:n,constant:c.readInt16(e)}}function H(e,t){var r=t||{};v.writeInt16(e,r.red),v.writeInt16(e,r.green),v.writeInt16(e,r.blue),v.writeZeros(e,2),v.writeInt16(e,r.constant)}h("PlLd",k("placedLayer"),(function(e,t,r){if("plcL"!==c.readSignature(e))throw new Error("Invalid PlLd signature");if(3!==c.readInt32(e))throw new Error("Invalid PlLd version");var n=c.readPascalString(e,1);c.readInt32(e),c.readInt32(e),c.readInt32(e);var o=c.readInt32(e);if(!O[o])throw new Error("Invalid PlLd type");for(var l=[],i=0;i<8;i++)l.push(c.readFloat64(e));var d=c.readInt32(e);if(0!==d)throw new Error("Invalid Warp version "+d);var v=f.readVersionAndDescriptor(e);t.placedLayer=t.placedLayer||{id:n,type:O[o],transform:l,warp:D(v)},c.skipBytes(e,r())}),(function(e,t){var r=t.placedLayer;if(v.writeSignature(e,"plcL"),v.writeInt32(e,3),v.writePascalString(e,r.id,1),v.writeInt32(e,1),v.writeInt32(e,1),v.writeInt32(e,16),-1===O.indexOf(r.type))throw new Error("Invalid placedLayer type");v.writeInt32(e,O.indexOf(r.type));for(var i=0;i<8;i++)v.writeFloat64(e,r.transform[i]);v.writeInt32(e,0);var n=r.warp&&x(r.warp)?"quiltWarp":"warp";f.writeVersionAndDescriptor(e,"",n,C(r.warp||{}),n)})),h("SoLd",k("placedLayer"),(function(e,t,r){if("soLD"!==c.readSignature(e))throw new Error("Invalid SoLd type");if(4!==c.readInt32(e))throw new Error("Invalid SoLd version");var desc=f.readVersionAndDescriptor(e);t.placedLayer={id:desc.Idnt,placed:desc.placed,type:O[desc.Type],transform:desc.Trnf,width:desc["Sz  "].Wdth,height:desc["Sz  "].Hght,resolution:f.parseUnits(desc.Rslt),warp:D(desc.quiltWarp||desc.warp)},desc.nonAffineTransform&&desc.nonAffineTransform.some((function(e,i){return e!==desc.Trnf[i]}))&&(t.placedLayer.nonAffineTransform=desc.nonAffineTransform),desc.Crop&&(t.placedLayer.crop=desc.Crop),desc.comp&&(t.placedLayer.comp=desc.comp),desc.compInfo&&(t.placedLayer.compInfo=desc.compInfo),c.skipBytes(e,r())}),(function(e,t){var r,o;v.writeSignature(e,"soLD"),v.writeInt32(e,4);var l=t.placedLayer,desc=n(n({Idnt:l.id,placed:null!==(r=l.placed)&&void 0!==r?r:l.id,PgNm:1,totalPages:1},l.crop?{Crop:l.crop}:{}),{frameStep:{numerator:0,denominator:600},duration:{numerator:0,denominator:600},frameCount:1,Annt:16,Type:O.indexOf(l.type),Trnf:l.transform,nonAffineTransform:null!==(o=l.nonAffineTransform)&&void 0!==o?o:l.transform,quiltWarp:{},warp:C(l.warp||{}),"Sz  ":{Wdth:l.width||0,Hght:l.height||0},Rslt:l.resolution?f.unitsValue(l.resolution,"resolution"):{units:"Density",value:72}});if(l.warp&&x(l.warp)){var d=C(l.warp);desc.quiltWarp=d,desc.warp={warpStyle:"warpStyle.warpNone",warpValue:d.warpValue,warpPerspective:d.warpPerspective,warpPerspectiveOther:d.warpPerspectiveOther,warpRotate:d.warpRotate,bounds:d.bounds,uOrder:d.uOrder,vOrder:d.vOrder}}else delete desc.quiltWarp;l.comp&&(desc.comp=l.comp),l.compInfo&&(desc.compInfo=l.compInfo),f.writeVersionAndDescriptor(e,"","null",desc,desc.quiltWarp?"quiltWarp":"warp")})),h("fxrp",k("referencePoint"),(function(e,t){t.referencePoint={x:c.readFloat64(e),y:c.readFloat64(e)}}),(function(e,t){v.writeFloat64(e,t.referencePoint.x),v.writeFloat64(e,t.referencePoint.y)})),d.MOCK_HANDLERS?h("Patt",(function(e){return void 0!==e._Patt}),(function(e,t,r){t._Patt=c.readBytes(e,r())}),(function(e,t){return!1})):h("Patt",(function(e){return!e}),(function(e,t,r){r()&&c.skipBytes(e,r())}),(function(e,t){})),h("Anno",(function(e){return void 0!==e.annotations}),(function(e,t,r){var n=c.readUint16(e),o=c.readUint16(e);if(2!==n||1!==o)throw new Error("Invalid Anno version");for(var l=c.readUint32(e),d=[],i=0;i<l;i++){c.readUint32(e);var v=c.readSignature(e),f=!!c.readUint8(e);c.readUint8(e),c.readUint16(e);var w=A(e),y=A(e),h=c.readColor(e),m=c.readPascalString(e,2),k=c.readPascalString(e,2),S=c.readPascalString(e,2);c.readUint32(e),c.readSignature(e);var U=c.readUint32(e),data=void 0;if("txtA"===v)U>=2&&65279===c.readUint16(e)?data=c.readUnicodeStringWithLength(e,(U-2)/2):(e.offset-=2,data=c.readAsciiString(e,U)),data=data.replace(/\r/g,"\n");else{if("sndA"!==v)throw new Error("Unknown annotation type");data=c.readBytes(e,U)}d.push({type:"txtA"===v?"text":"sound",open:f,iconLocation:w,popupLocation:y,color:h,author:m,name:k,date:S,data:data})}t.annotations=d,c.skipBytes(e,r())}),(function(e,t){var r=t.annotations;v.writeUint16(e,2),v.writeUint16(e,1),v.writeUint32(e,r.length);for(var n=0,o=r;n<o.length;n++){var l=o[n],d="sound"===l.type;if(d&&!(l.data instanceof Uint8Array))throw new Error("Sound annotation data should be Uint8Array");if(!d&&"string"!=typeof l.data)throw new Error("Text annotation data should be string");var c=e.offset;v.writeUint32(e,0),v.writeSignature(e,d?"sndA":"txtA"),v.writeUint8(e,l.open?1:0),v.writeUint8(e,28),v.writeUint16(e,1),L(e,l.iconLocation),L(e,l.popupLocation),v.writeColor(e,l.color),v.writePascalString(e,l.author||"",2),v.writePascalString(e,l.name||"",2),v.writePascalString(e,l.date||"",2);var f=e.offset;v.writeUint32(e,0),v.writeSignature(e,d?"sndM":"txtC"),v.writeUint32(e,0);var w=e.offset;if(d)v.writeBytes(e,l.data);else{v.writeUint16(e,65279);for(var text=l.data.replace(/\n/g,"\r"),i=0;i<text.length;i++)v.writeUint16(e,text.charCodeAt(i))}e.view.setUint32(c,e.offset-c,!1),e.view.setUint32(f,e.offset-f,!1),e.view.setUint32(w-4,e.offset-w,!1)}})),h("lnk2",(function(e){return!!e.linkedFiles&&e.linkedFiles.length>0}),(function(e,t,r,n,o){var l=t;for(l.linkedFiles=[];r()>8;){var d=S(e),v=e.offset,w=c.readSignature(e),y=c.readInt32(e),h=c.readPascalString(e,1),m=c.readUnicodeString(e),k=c.readSignature(e).trim(),U=c.readSignature(e).trim(),I=S(e),F=c.readUint8(e)?f.readVersionAndDescriptor(e):void 0,P=("liFE"===w&&f.readVersionAndDescriptor(e),{id:h,name:m,data:void 0});if(k&&(P.type=k),U&&(P.creator=U),F&&(P.descriptor=F),"liFE"===w&&y>3){var O=c.readInt32(e),D=c.readUint8(e),x=c.readUint8(e),C=c.readUint8(e),A=c.readUint8(e),L=c.readFloat64(e),B=Math.floor(L),E=1e3*(L-B);P.time=new Date(O,D,x,C,A,B,E)}var T="liFE"===w?S(e):0;for("liFA"===w&&c.skipBytes(e,8),"liFD"===w&&(P.data=c.readBytes(e,I)),y>=5&&(P.childDocumentID=c.readUnicodeString(e)),y>=6&&(P.assetModTime=c.readFloat64(e)),y>=7&&(P.assetLockedState=c.readUint8(e)),"liFE"===w&&(P.data=c.readBytes(e,T)),o.skipLinkedFilesData&&(P.data=void 0),l.linkedFiles.push(P);d%4;)d++;e.offset=v+d}c.skipBytes(e,r())}),(function(e,t){for(var r=0,n=t.linkedFiles;r<n.length;r++){var o=n[r],l=2;null!=o.assetLockedState?l=7:null!=o.assetModTime?l=6:null!=o.childDocumentID&&(l=5),v.writeUint32(e,0),v.writeUint32(e,0);var d=e.offset;if(v.writeSignature(e,o.data?"liFD":"liFA"),v.writeInt32(e,l),v.writePascalString(e,o.id||"",1),v.writeUnicodeStringWithPadding(e,o.name||""),v.writeSignature(e,o.type?(o.type+"    ").substr(0,4):"    "),v.writeSignature(e,o.creator?(o.creator+"    ").substr(0,4):"\0\0\0\0"),U(e,o.data?o.data.byteLength:0),o.descriptor&&o.descriptor.compInfo){var desc={compInfo:o.descriptor.compInfo};v.writeUint8(e,1),f.writeVersionAndDescriptor(e,"","null",desc)}else v.writeUint8(e,0);o.data?v.writeBytes(e,o.data):U(e,0),l>=5&&v.writeUnicodeStringWithPadding(e,o.childDocumentID||""),l>=6&&v.writeFloat64(e,o.assetModTime||0),l>=7&&v.writeUint8(e,o.assetLockedState||0);var c=e.offset-d;for(e.view.setUint32(d-4,c,!1);c%4;)c++,v.writeUint8(e,0)}})),m("lnkD","lnk2"),m("lnk3","lnk2"),h("lnkE",(function(e){return void 0!==e._lnkE}),(function(e,t,r,n,o){o.logMissingFeatures&&r()&&console.log("Non-empty lnkE layer info ("+r()+" bytes)"),d.MOCK_HANDLERS&&(t._lnkE=c.readBytes(e,r()))}),(function(e,t){return d.MOCK_HANDLERS&&v.writeBytes(e,t._lnkE)})),h("pths",k("pathList"),(function(e,t){f.readVersionAndDescriptor(e);t.pathList=[]}),(function(e,t){f.writeVersionAndDescriptor(e,"","pathsDataClass",{pathList:[]})})),h("lyvr",k("version"),(function(e,t){return t.version=c.readUint32(e)}),(function(e,t){return v.writeUint32(e,t.version)})),h("brit",B("brightness/contrast"),(function(e,t,r){t.adjustment||(t.adjustment={type:"brightness/contrast",brightness:c.readInt16(e),contrast:c.readInt16(e),meanValue:c.readInt16(e),labColorOnly:!!c.readUint8(e),useLegacy:!0}),c.skipBytes(e,r())}),(function(e,t){var r,n=t.adjustment;v.writeInt16(e,n.brightness||0),v.writeInt16(e,n.contrast||0),v.writeInt16(e,null!==(r=n.meanValue)&&void 0!==r?r:127),v.writeUint8(e,n.labColorOnly?1:0),v.writeZeros(e,1)})),h("levl",B("levels"),(function(e,t,r){if(2!==c.readUint16(e))throw new Error("Invalid levl version");t.adjustment=n(n({},t.adjustment),{type:"levels",rgb:E(e),red:E(e),green:E(e),blue:E(e)}),c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment,n={shadowInput:0,highlightInput:255,shadowOutput:0,highlightOutput:255,midtoneInput:1};v.writeUint16(e,2),T(e,r.rgb||n),T(e,r.red||n),T(e,r.blue||n),T(e,r.green||n);for(var i=0;i<59;i++)T(e,n)})),h("curv",B("curves"),(function(e,t,r){if(c.readUint8(e),1!==c.readUint16(e))throw new Error("Invalid curv version");c.readUint16(e);var o=c.readUint16(e),l={type:"curves"};1&o&&(l.rgb=M(e)),2&o&&(l.red=M(e)),4&o&&(l.green=M(e)),8&o&&(l.blue=M(e)),t.adjustment=n(n({},t.adjustment),l),c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment,n=r.rgb,o=r.red,l=r.green,d=r.blue,c=0,f=0;n&&n.length&&(c|=1,f++),o&&o.length&&(c|=2,f++),l&&l.length&&(c|=4,f++),d&&d.length&&(c|=8,f++),v.writeUint8(e,0),v.writeUint16(e,1),v.writeUint16(e,0),v.writeUint16(e,c),n&&n.length&&V(e,n),o&&o.length&&V(e,o),l&&l.length&&V(e,l),d&&d.length&&V(e,d),v.writeSignature(e,"Crv "),v.writeUint16(e,4),v.writeUint16(e,0),v.writeUint16(e,f),n&&n.length&&(v.writeUint16(e,0),V(e,n)),o&&o.length&&(v.writeUint16(e,1),V(e,o)),l&&l.length&&(v.writeUint16(e,2),V(e,l)),d&&d.length&&(v.writeUint16(e,3),V(e,d)),v.writeZeros(e,2)})),h("expA",B("exposure"),(function(e,t,r){if(1!==c.readUint16(e))throw new Error("Invalid expA version");t.adjustment=n(n({},t.adjustment),{type:"exposure",exposure:c.readFloat32(e),offset:c.readFloat32(e),gamma:c.readFloat32(e)}),c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment;v.writeUint16(e,1),v.writeFloat32(e,r.exposure),v.writeFloat32(e,r.offset),v.writeFloat32(e,r.gamma),v.writeZeros(e,2)})),h("vibA",B("vibrance"),(function(e,t,r){var desc=f.readVersionAndDescriptor(e);t.adjustment={type:"vibrance"},void 0!==desc.vibrance&&(t.adjustment.vibrance=desc.vibrance),void 0!==desc.Strt&&(t.adjustment.saturation=desc.Strt),c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment,desc={};void 0!==r.vibrance&&(desc.vibrance=r.vibrance),void 0!==r.saturation&&(desc.Strt=r.saturation),f.writeVersionAndDescriptor(e,"","null",desc)})),h("hue2",B("hue/saturation"),(function(e,t,r){if(2!==c.readUint16(e))throw new Error("Invalid hue2 version");t.adjustment=n(n({},t.adjustment),{type:"hue/saturation",master:N(e),reds:N(e),yellows:N(e),greens:N(e),cyans:N(e),blues:N(e),magentas:N(e)}),c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment;v.writeUint16(e,2),R(e,r.master),R(e,r.reds),R(e,r.yellows),R(e,r.greens),R(e,r.cyans),R(e,r.blues),R(e,r.magentas)})),h("blnc",B("color balance"),(function(e,t,r){t.adjustment={type:"color balance",shadows:G(e),midtones:G(e),highlights:G(e),preserveLuminosity:!!c.readUint8(e)},c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment;j(e,r.shadows||{}),j(e,r.midtones||{}),j(e,r.highlights||{}),v.writeUint8(e,r.preserveLuminosity?1:0),v.writeZeros(e,1)})),h("blwh",B("black & white"),(function(e,t,r){var desc=f.readVersionAndDescriptor(e);t.adjustment={type:"black & white",reds:desc["Rd  "],yellows:desc.Yllw,greens:desc["Grn "],cyans:desc["Cyn "],blues:desc["Bl  "],magentas:desc.Mgnt,useTint:!!desc.useTint,presetKind:desc.bwPresetKind,presetFileName:desc.blackAndWhitePresetFileName},void 0!==desc.tintColor&&(t.adjustment.tintColor=ce(desc.tintColor)),c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment,desc={"Rd  ":r.reds||0,Yllw:r.yellows||0,"Grn ":r.greens||0,"Cyn ":r.cyans||0,"Bl  ":r.blues||0,Mgnt:r.magentas||0,useTint:!!r.useTint,tintColor:ue(r.tintColor),bwPresetKind:r.presetKind||0,blackAndWhitePresetFileName:r.presetFileName||""};f.writeVersionAndDescriptor(e,"","null",desc)})),h("phfl",B("photo filter"),(function(e,t,r){var n,o=c.readUint16(e);if(2!==o&&3!==o)throw new Error("Invalid phfl version");n=2===o?c.readColor(e):{l:c.readInt32(e)/100,a:c.readInt32(e)/100,b:c.readInt32(e)/100},t.adjustment={type:"photo filter",color:n,density:c.readUint32(e)/100,preserveLuminosity:!!c.readUint8(e)},c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment;v.writeUint16(e,2),v.writeColor(e,r.color||{l:0,a:0,b:0}),v.writeUint32(e,100*(r.density||0)),v.writeUint8(e,r.preserveLuminosity?1:0),v.writeZeros(e,3)})),h("mixr",B("channel mixer"),(function(e,t,r){if(1!==c.readUint16(e))throw new Error("Invalid mixr version");var o=t.adjustment=n(n({},t.adjustment),{type:"channel mixer",monochrome:!!c.readUint16(e)});o.monochrome||(o.red=z(e),o.green=z(e),o.blue=z(e)),o.gray=z(e),c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment;v.writeUint16(e,1),v.writeUint16(e,r.monochrome?1:0),r.monochrome?(H(e,r.gray),v.writeZeros(e,30)):(H(e,r.red),H(e,r.green),H(e,r.blue),H(e,r.gray))}));var W=d.createEnum("colorLookupType","3DLUT",{"3dlut":"3DLUT",abstractProfile:"abstractProfile",deviceLinkProfile:"deviceLinkProfile"}),K=d.createEnum("LUTFormatType","look",{look:"LUTFormatLOOK",cube:"LUTFormatCUBE","3dl":"LUTFormat3DL"}),Z=d.createEnum("colorLookupOrder","rgb",{rgb:"rgbOrder",bgr:"bgrOrder"});h("clrL",B("color lookup"),(function(e,t,r){if(1!==c.readUint16(e))throw new Error("Invalid clrL version");var desc=f.readVersionAndDescriptor(e);t.adjustment={type:"color lookup"};var n=t.adjustment;void 0!==desc.lookupType&&(n.lookupType=W.decode(desc.lookupType)),void 0!==desc["Nm  "]&&(n.name=desc["Nm  "]),void 0!==desc.Dthr&&(n.dither=desc.Dthr),void 0!==desc.profile&&(n.profile=desc.profile),void 0!==desc.LUTFormat&&(n.lutFormat=K.decode(desc.LUTFormat)),void 0!==desc.dataOrder&&(n.dataOrder=Z.decode(desc.dataOrder)),void 0!==desc.tableOrder&&(n.tableOrder=Z.decode(desc.tableOrder)),void 0!==desc.LUT3DFileData&&(n.lut3DFileData=desc.LUT3DFileData),void 0!==desc.LUT3DFileName&&(n.lut3DFileName=desc.LUT3DFileName),c.skipBytes(e,r())}),(function(e,t){var r=t.adjustment,desc={};void 0!==r.lookupType&&(desc.lookupType=W.encode(r.lookupType)),void 0!==r.name&&(desc["Nm  "]=r.name),void 0!==r.dither&&(desc.Dthr=r.dither),void 0!==r.profile&&(desc.profile=r.profile),void 0!==r.lutFormat&&(desc.LUTFormat=K.encode(r.lutFormat)),void 0!==r.dataOrder&&(desc.dataOrder=Z.encode(r.dataOrder)),void 0!==r.tableOrder&&(desc.tableOrder=Z.encode(r.tableOrder)),void 0!==r.lut3DFileData&&(desc.LUT3DFileData=r.lut3DFileData),void 0!==r.lut3DFileName&&(desc.LUT3DFileName=r.lut3DFileName),v.writeUint16(e,1),f.writeVersionAndDescriptor(e,"","null",desc)})),h("nvrt",B("invert"),(function(e,t,r){t.adjustment={type:"invert"},c.skipBytes(e,r())}),(function(){})),h("post",B("posterize"),(function(e,t,r){t.adjustment={type:"posterize",levels:c.readUint16(e)},c.skipBytes(e,r())}),(function(e,t){var r,n=t.adjustment;v.writeUint16(e,null!==(r=n.levels)&&void 0!==r?r:4),v.writeZeros(e,2)})),h("thrs",B("threshold"),(function(e,t,r){t.adjustment={type:"threshold",level:c.readUint16(e)},c.skipBytes(e,r())}),(function(e,t){var r,n=t.adjustment;v.writeUint16(e,null!==(r=n.level)&&void 0!==r?r:128),v.writeZeros(e,2)}));var X=["","","","rgb","hsb","","lab"];function _(e){return{c:c.readInt16(e),m:c.readInt16(e),y:c.readInt16(e),k:c.readInt16(e)}}function Y(e,t){var r=t||{};v.writeInt16(e,r.c),v.writeInt16(e,r.m),v.writeInt16(e,r.y),v.writeInt16(e,r.k)}function J(e){var t={enabled:!!e.enab,position:f.FStl.decode(e.Styl),fillType:f.FrFl.decode(e.PntT),blendMode:f.BlnM.decode(e["Md  "]),opacity:f.parsePercent(e.Opct),size:f.parseUnits(e["Sz  "])};return void 0!==e.present&&(t.present=e.present),void 0!==e.showInDialog&&(t.showInDialog=e.showInDialog),void 0!==e.overprint&&(t.overprint=e.overprint),e["Clr "]&&(t.color=ce(e["Clr "])),e.Grad&&(t.gradient=ie(e)),e.Ptrn&&(t.pattern=oe(e)),t}function Q(e){var t={};return t.enab=!!e.enabled,void 0!==e.present&&(t.present=!!e.present),void 0!==e.showInDialog&&(t.showInDialog=!!e.showInDialog),t.Styl=f.FStl.encode(e.position),t.PntT=f.FrFl.encode(e.fillType),t["Md  "]=f.BlnM.encode(e.blendMode),t.Opct=f.unitsPercent(e.opacity),t["Sz  "]=f.unitsValue(e.size,"size"),e.color&&(t["Clr "]=ue(e.color)),e.gradient&&(t=n(n({},t),se(e.gradient))),e.pattern&&(t=n(n({},t),le(e.pattern))),void 0!==e.overprint&&(t.overprint=!!e.overprint),t}function $(e,t){var r={};return e.masterFXSwitch||(r.disabled=!0),e["Scl "]&&(r.scale=f.parsePercent(e["Scl "])),e.DrSh&&(r.dropShadow=[pe(e.DrSh,t)]),e.dropShadowMulti&&(r.dropShadow=e.dropShadowMulti.map((function(i){return pe(i,t)}))),e.IrSh&&(r.innerShadow=[pe(e.IrSh,t)]),e.innerShadowMulti&&(r.innerShadow=e.innerShadowMulti.map((function(i){return pe(i,t)}))),e.OrGl&&(r.outerGlow=pe(e.OrGl,t)),e.IrGl&&(r.innerGlow=pe(e.IrGl,t)),e.ebbl&&(r.bevel=pe(e.ebbl,t)),e.SoFi&&(r.solidFill=[pe(e.SoFi,t)]),e.solidFillMulti&&(r.solidFill=e.solidFillMulti.map((function(i){return pe(i,t)}))),e.patternFill&&(r.patternOverlay=pe(e.patternFill,t)),e.GrFl&&(r.gradientOverlay=[pe(e.GrFl,t)]),e.gradientFillMulti&&(r.gradientOverlay=e.gradientFillMulti.map((function(i){return pe(i,t)}))),e.ChFX&&(r.satin=pe(e.ChFX,t)),e.FrFX&&(r.stroke=[J(e.FrFX)]),e.frameFXMulti&&(r.stroke=e.frameFXMulti.map((function(i){return J(i)}))),r}function ee(e,t,r){for(var n,o,l,d,c,v,w,y,h,m,k,S,U,I=r?{"Scl ":f.unitsPercent(null!==(n=e.scale)&&void 0!==n?n:1),masterFXSwitch:!e.disabled}:{masterFXSwitch:!e.disabled,"Scl ":f.unitsPercent(null!==(o=e.scale)&&void 0!==o?o:1)},F=0,P=["dropShadow","innerShadow","solidFill","gradientOverlay","stroke"];F<P.length;F++){if(e[x=P[F]]&&!Array.isArray(e[x]))throw new Error(x+" should be an array")}if((null===(l=e.dropShadow)||void 0===l?void 0:l[0])&&!r&&(I.DrSh=ve(e.dropShadow[0],"dropShadow",t)),(null===(d=e.dropShadow)||void 0===d?void 0:d[0])&&r&&(I.dropShadowMulti=e.dropShadow.map((function(i){return ve(i,"dropShadow",t)}))),(null===(c=e.innerShadow)||void 0===c?void 0:c[0])&&!r&&(I.IrSh=ve(e.innerShadow[0],"innerShadow",t)),(null===(v=e.innerShadow)||void 0===v?void 0:v[0])&&r&&(I.innerShadowMulti=e.innerShadow.map((function(i){return ve(i,"innerShadow",t)}))),e.outerGlow&&(I.OrGl=ve(e.outerGlow,"outerGlow",t)),(null===(w=e.solidFill)||void 0===w?void 0:w[0])&&r&&(I.solidFillMulti=e.solidFill.map((function(i){return ve(i,"solidFill",t)}))),(null===(y=e.gradientOverlay)||void 0===y?void 0:y[0])&&r&&(I.gradientFillMulti=e.gradientOverlay.map((function(i){return ve(i,"gradientOverlay",t)}))),(null===(h=e.stroke)||void 0===h?void 0:h[0])&&r&&(I.frameFXMulti=e.stroke.map((function(i){return Q(i)}))),e.innerGlow&&(I.IrGl=ve(e.innerGlow,"innerGlow",t)),e.bevel&&(I.ebbl=ve(e.bevel,"bevel",t)),(null===(m=e.solidFill)||void 0===m?void 0:m[0])&&!r&&(I.SoFi=ve(e.solidFill[0],"solidFill",t)),e.patternOverlay&&(I.patternFill=ve(e.patternOverlay,"patternOverlay",t)),(null===(k=e.gradientOverlay)||void 0===k?void 0:k[0])&&!r&&(I.GrFl=ve(e.gradientOverlay[0],"gradientOverlay",t)),e.satin&&(I.ChFX=ve(e.satin,"satin",t)),(null===(S=e.stroke)||void 0===S?void 0:S[0])&&!r&&(I.FrFX=Q(null===(U=e.stroke)||void 0===U?void 0:U[0])),r){I.numModifyingFX=0;for(var O=0,D=Object.keys(e);O<D.length;O++){var x,C=e[x=D[O]];if(Array.isArray(C))for(var A=0,L=C;A<L.length;A++){L[A].enabled&&I.numModifyingFX++}}}return I}function te(e){return Object.keys(e).map((function(t){return e[t]})).some((function(e){return Array.isArray(e)&&e.length>1}))}function re(e){if("GrdF.CstS"===e.GrdF){var t=e.Intr||4096;return{type:"solid",name:e["Nm  "],smoothness:e.Intr/4096,colorStops:e.Clrs.map((function(s){return{color:ce(s["Clr "]),location:s.Lctn/t,midpoint:s.Mdpn/100}})),opacityStops:e.Trns.map((function(s){return{opacity:f.parsePercent(s.Opct),location:s.Lctn/t,midpoint:s.Mdpn/100}}))}}return{type:"noise",name:e["Nm  "],roughness:e.Smth/4096,colorModel:f.ClrS.decode(e.ClrS),randomSeed:e.RndS,restrictColors:!!e.VctC,addTransparency:!!e.ShTr,min:e["Mnm "].map((function(e){return e/100})),max:e["Mxm "].map((function(e){return e/100}))}}function ne(e){var t,r;if("solid"===e.type){var n=Math.round(4096*(null!==(t=e.smoothness)&&void 0!==t?t:1));return{"Nm  ":e.name||"",GrdF:"GrdF.CstS",Intr:n,Clrs:e.colorStops.map((function(s){var e;return{"Clr ":ue(s.color),Type:"Clry.UsrS",Lctn:Math.round(s.location*n),Mdpn:Math.round(100*(null!==(e=s.midpoint)&&void 0!==e?e:.5))}})),Trns:e.opacityStops.map((function(s){var e;return{Opct:f.unitsPercent(s.opacity),Lctn:Math.round(s.location*n),Mdpn:Math.round(100*(null!==(e=s.midpoint)&&void 0!==e?e:.5))}}))}}return{GrdF:"GrdF.ClNs","Nm  ":e.name||"",ShTr:!!e.addTransparency,VctC:!!e.restrictColors,ClrS:f.ClrS.encode(e.colorModel),RndS:e.randomSeed||0,Smth:Math.round(4096*(null!==(r=e.roughness)&&void 0!==r?r:1)),"Mnm ":(e.min||[0,0,0,0]).map((function(e){return 100*e})),"Mxm ":(e.max||[1,1,1,1]).map((function(e){return 100*e}))}}function ie(e){var t=re(e.Grad);return t.style=f.GrdT.decode(e.Type),void 0!==e.Dthr&&(t.dither=e.Dthr),void 0!==e.Rvrs&&(t.reverse=e.Rvrs),void 0!==e.Angl&&(t.angle=f.parseAngle(e.Angl)),void 0!==e["Scl "]&&(t.scale=f.parsePercent(e["Scl "])),void 0!==e.Algn&&(t.align=e.Algn),void 0!==e.Ofst&&(t.offset={x:f.parsePercent(e.Ofst.Hrzn),y:f.parsePercent(e.Ofst.Vrtc)}),t}function oe(e){var t={name:e.Ptrn["Nm  "],id:e.Ptrn.Idnt};return void 0!==e.Lnkd&&(t.linked=e.Lnkd),void 0!==e.phase&&(t.phase={x:e.phase.Hrzn,y:e.phase.Vrtc}),t}function ae(e){if("Grad"in e)return ie(e);if("Ptrn"in e)return n({type:"pattern"},oe(e));if("Clr "in e)return{type:"color",color:ce(e["Clr "])};throw new Error("Invalid vector content")}function se(content){var e={};return void 0!==content.dither&&(e.Dthr=content.dither),void 0!==content.reverse&&(e.Rvrs=content.reverse),void 0!==content.angle&&(e.Angl=f.unitsAngle(content.angle)),e.Type=f.GrdT.encode(content.style),void 0!==content.align&&(e.Algn=content.align),void 0!==content.scale&&(e["Scl "]=f.unitsPercent(content.scale)),content.offset&&(e.Ofst={Hrzn:f.unitsPercent(content.offset.x),Vrtc:f.unitsPercent(content.offset.y)}),e.Grad=ne(content),e}function le(content){var e={Ptrn:{"Nm  ":content.name||"",Idnt:content.id||""}};return void 0!==content.linked&&(e.Lnkd=!!content.linked),void 0!==content.phase&&(e.phase={Hrzn:content.phase.x,Vrtc:content.phase.y}),e}function de(content){return"color"===content.type?{key:"SoCo",descriptor:{"Clr ":ue(content.color)}}:"pattern"===content.type?{key:"PtFl",descriptor:le(content)}:{key:"GdFl",descriptor:se(content)}}function ce(e){if("H   "in e)return{h:f.parsePercentOrAngle(e["H   "]),s:e.Strt,b:e.Brgh};if("Rd  "in e)return{r:e["Rd  "],g:e["Grn "],b:e["Bl  "]};if("Cyn "in e)return{c:e["Cyn "],m:e.Mgnt,y:e["Ylw "],k:e.Blck};if("Gry "in e)return{k:e["Gry "]};if("Lmnc"in e)return{l:e.Lmnc,a:e["A   "],b:e["B   "]};throw new Error("Unsupported color descriptor")}function ue(e){if(e){if("r"in e)return{"Rd  ":e.r||0,"Grn ":e.g||0,"Bl  ":e.b||0};if("h"in e)return{"H   ":f.unitsAngle(360*e.h),Strt:e.s||0,Brgh:e.b||0};if("c"in e)return{"Cyn ":e.c||0,Mgnt:e.m||0,"Ylw ":e.y||0,Blck:e.k||0};if("l"in e)return{Lmnc:e.l||0,"A   ":e.a||0,"B   ":e.b||0};if("k"in e)return{"Gry ":e.k};throw new Error("Invalid color value")}return{"Rd  ":0,"Grn ":0,"Bl  ":0}}function pe(e,t){for(var r={},n=0,o=Object.keys(e);n<o.length;n++){var l=o[n],d=e[l];switch(l){case"enab":r.enabled=!!d;break;case"uglg":r.useGlobalLight=!!d;break;case"AntA":r.antialiased=!!d;break;case"Algn":r.align=!!d;break;case"Dthr":r.dither=!!d;break;case"Invr":r.invert=!!d;break;case"Rvrs":r.reverse=!!d;break;case"Clr ":r.color=ce(d);break;case"hglC":r.highlightColor=ce(d);break;case"sdwC":r.shadowColor=ce(d);break;case"Styl":r.position=f.FStl.decode(d);break;case"Md  ":r.blendMode=f.BlnM.decode(d);break;case"hglM":r.highlightBlendMode=f.BlnM.decode(d);break;case"sdwM":r.shadowBlendMode=f.BlnM.decode(d);break;case"bvlS":r.style=f.BESl.decode(d);break;case"bvlD":r.direction=f.BESs.decode(d);break;case"bvlT":r.technique=f.bvlT.decode(d);break;case"GlwT":r.technique=f.BETE.decode(d);break;case"glwS":r.source=f.IGSr.decode(d);break;case"Type":r.type=f.GrdT.decode(d);break;case"Opct":r.opacity=f.parsePercent(d);break;case"hglO":r.highlightOpacity=f.parsePercent(d);break;case"sdwO":r.shadowOpacity=f.parsePercent(d);break;case"lagl":case"Angl":r.angle=f.parseAngle(d);break;case"Lald":r.altitude=f.parseAngle(d);break;case"Sftn":r.soften=f.parseUnits(d);break;case"srgR":r.strength=f.parsePercent(d);break;case"blur":r.size=f.parseUnits(d);break;case"Nose":r.noise=f.parsePercent(d);break;case"Inpr":r.range=f.parsePercent(d);break;case"Ckmt":r.choke=f.parseUnits(d);break;case"ShdN":r.jitter=f.parsePercent(d);break;case"Dstn":r.distance=f.parseUnits(d);break;case"Scl ":r.scale=f.parsePercent(d);break;case"Ptrn":r.pattern={name:d["Nm  "],id:d.Idnt};break;case"phase":r.phase={x:d.Hrzn,y:d.Vrtc};break;case"Ofst":r.offset={x:f.parsePercent(d.Hrzn),y:f.parsePercent(d.Vrtc)};break;case"MpgS":case"TrnS":r.contour={name:d["Nm  "],curve:d["Crv "].map((function(p){return{x:p.Hrzn,y:p.Vrtc}}))};break;case"Grad":r.gradient=re(d);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":r[l]=d;break;default:t&&console.log("Invalid effect key: '"+l+"':",d)}}return r}function ve(e,t,r){for(var n={},o=0,l=Object.keys(e);o<l.length;o++){var d=l[o],c=e[d];switch(d){case"enabled":n.enab=!!c;break;case"useGlobalLight":n.uglg=!!c;break;case"antialiased":n.AntA=!!c;break;case"align":n.Algn=!!c;break;case"dither":n.Dthr=!!c;break;case"invert":n.Invr=!!c;break;case"reverse":n.Rvrs=!!c;break;case"color":n["Clr "]=ue(c);break;case"highlightColor":n.hglC=ue(c);break;case"shadowColor":n.sdwC=ue(c);break;case"position":n.Styl=f.FStl.encode(c);break;case"blendMode":n["Md  "]=f.BlnM.encode(c);break;case"highlightBlendMode":n.hglM=f.BlnM.encode(c);break;case"shadowBlendMode":n.sdwM=f.BlnM.encode(c);break;case"style":n.bvlS=f.BESl.encode(c);break;case"direction":n.bvlD=f.BESs.encode(c);break;case"technique":"bevel"===t?n.bvlT=f.bvlT.encode(c):n.GlwT=f.BETE.encode(c);break;case"source":n.glwS=f.IGSr.encode(c);break;case"type":n.Type=f.GrdT.encode(c);break;case"opacity":n.Opct=f.unitsPercent(c);break;case"highlightOpacity":n.hglO=f.unitsPercent(c);break;case"shadowOpacity":n.sdwO=f.unitsPercent(c);break;case"angle":"gradientOverlay"===t?n.Angl=f.unitsAngle(c):n.lagl=f.unitsAngle(c);break;case"altitude":n.Lald=f.unitsAngle(c);break;case"soften":n.Sftn=f.unitsValue(c,d);break;case"strength":n.srgR=f.unitsPercent(c);break;case"size":n.blur=f.unitsValue(c,d);break;case"noise":n.Nose=f.unitsPercent(c);break;case"range":n.Inpr=f.unitsPercent(c);break;case"choke":n.Ckmt=f.unitsValue(c,d);break;case"jitter":n.ShdN=f.unitsPercent(c);break;case"distance":n.Dstn=f.unitsValue(c,d);break;case"scale":n["Scl "]=f.unitsPercent(c);break;case"pattern":n.Ptrn={"Nm  ":c.name,Idnt:c.id};break;case"phase":n.phase={Hrzn:c.x,Vrtc:c.y};break;case"offset":n.Ofst={Hrzn:f.unitsPercent(c.x),Vrtc:f.unitsPercent(c.y)};break;case"contour":n["satin"===t?"MpgS":"TrnS"]={"Nm  ":c.name,"Crv ":c.curve.map((function(p){return{Hrzn:p.x,Vrtc:p.y}}))};break;case"gradient":n.Grad=ne(c);break;case"useTexture":case"useShape":case"layerConceals":case"present":case"showInDialog":case"antialiasGloss":n[d]=c;break;default:r&&console.log("Invalid effect key: '"+d+"' value:",c)}}return n}h("grdm",B("gradient map"),(function(e,t,r){if(1!==c.readUint16(e))throw new Error("Invalid grdm version");var n={type:"gradient map",gradientType:"solid"};n.reverse=!!c.readUint8(e),n.dither=!!c.readUint8(e),n.name=c.readUnicodeString(e),n.colorStops=[],n.opacityStops=[];for(var o=c.readUint16(e),i=0;i<o;i++)n.colorStops.push({location:c.readUint32(e),midpoint:c.readUint32(e)/100,color:c.readColor(e)}),c.skipBytes(e,2);var l=c.readUint16(e);for(i=0;i<l;i++)n.opacityStops.push({location:c.readUint32(e),midpoint:c.readUint32(e)/100,opacity:c.readUint16(e)/255});if(2!==c.readUint16(e))throw new Error("Invalid grdm expansion count");var d=c.readUint16(e);if(n.smoothness=d/4096,32!==c.readUint16(e))throw new Error("Invalid grdm length");n.gradientType=c.readUint16(e)?"noise":"solid",n.randomSeed=c.readUint32(e),n.addTransparency=!!c.readUint16(e),n.restrictColors=!!c.readUint16(e),n.roughness=c.readUint32(e)/4096,n.colorModel=X[c.readUint16(e)]||"rgb",n.min=[c.readUint16(e)/32768,c.readUint16(e)/32768,c.readUint16(e)/32768,c.readUint16(e)/32768],n.max=[c.readUint16(e)/32768,c.readUint16(e)/32768,c.readUint16(e)/32768,c.readUint16(e)/32768],c.skipBytes(e,r());for(var v=0,f=n.colorStops;v<f.length;v++){f[v].location/=d}for(var w=0,y=n.opacityStops;w<y.length;w++){y[w].location/=d}t.adjustment=n}),(function(e,t){var r,n,o,l=t.adjustment;v.writeUint16(e,1),v.writeUint8(e,l.reverse?1:0),v.writeUint8(e,l.dither?1:0),v.writeUnicodeStringWithPadding(e,l.name||""),v.writeUint16(e,l.colorStops&&l.colorStops.length||0);for(var d=Math.round(4096*(null!==(r=l.smoothness)&&void 0!==r?r:1)),c=0,f=l.colorStops||[];c<f.length;c++){var s=f[c];v.writeUint32(e,Math.round(s.location*d)),v.writeUint32(e,Math.round(100*s.midpoint)),v.writeColor(e,s.color),v.writeZeros(e,2)}v.writeUint16(e,l.opacityStops&&l.opacityStops.length||0);for(var w=0,y=l.opacityStops||[];w<y.length;w++){s=y[w];v.writeUint32(e,Math.round(s.location*d)),v.writeUint32(e,Math.round(100*s.midpoint)),v.writeUint16(e,Math.round(255*s.opacity))}v.writeUint16(e,2),v.writeUint16(e,d),v.writeUint16(e,32),v.writeUint16(e,"noise"===l.gradientType?1:0),v.writeUint32(e,l.randomSeed||0),v.writeUint16(e,l.addTransparency?1:0),v.writeUint16(e,l.restrictColors?1:0),v.writeUint32(e,Math.round(4096*(null!==(n=l.roughness)&&void 0!==n?n:1)));var h=X.indexOf(null!==(o=l.colorModel)&&void 0!==o?o:"rgb");v.writeUint16(e,-1===h?3:h);for(var i=0;i<4;i++)v.writeUint16(e,Math.round(32768*(l.min&&l.min[i]||0)));for(i=0;i<4;i++)v.writeUint16(e,Math.round(32768*(l.max&&l.max[i]||0)));v.writeZeros(e,4)})),h("selc",B("selective color"),(function(e,t){if(1!==c.readUint16(e))throw new Error("Invalid selc version");var r=c.readUint16(e)?"absolute":"relative";c.skipBytes(e,8),t.adjustment={type:"selective color",mode:r,reds:_(e),yellows:_(e),greens:_(e),cyans:_(e),blues:_(e),magentas:_(e),whites:_(e),neutrals:_(e),blacks:_(e)}}),(function(e,t){var r=t.adjustment;v.writeUint16(e,1),v.writeUint16(e,"absolute"===r.mode?1:0),v.writeZeros(e,8),Y(e,r.reds),Y(e,r.yellows),Y(e,r.greens),Y(e,r.cyans),Y(e,r.blues),Y(e,r.magentas),Y(e,r.whites),Y(e,r.neutrals),Y(e,r.blacks)})),h("CgEd",(function(e){var a=e.adjustment;return!!a&&("brightness/contrast"===a.type&&!a.useLegacy||("levels"===a.type||"curves"===a.type||"exposure"===a.type||"channel mixer"===a.type||"hue/saturation"===a.type)&&void 0!==a.presetFileName)}),(function(e,t,r){var desc=f.readVersionAndDescriptor(e);if(1!==desc.Vrsn)throw new Error("Invalid CgEd version");t.adjustment="presetFileName"in desc?n(n({},t.adjustment),{presetKind:desc.presetKind,presetFileName:desc.presetFileName}):"curvesPresetFileName"in desc?n(n({},t.adjustment),{presetKind:desc.curvesPresetKind,presetFileName:desc.curvesPresetFileName}):"mixerPresetFileName"in desc?n(n({},t.adjustment),{presetKind:desc.mixerPresetKind,presetFileName:desc.mixerPresetFileName}):{type:"brightness/contrast",brightness:desc.Brgh,contrast:desc.Cntr,meanValue:desc.means,useLegacy:!!desc.useLegacy,labColorOnly:!!desc["Lab "],auto:!!desc.Auto},c.skipBytes(e,r())}),(function(e,t){var r,n,o,l,d=t.adjustment;if("levels"===d.type||"exposure"===d.type||"hue/saturation"===d.type){var desc={Vrsn:1,presetKind:null!==(r=d.presetKind)&&void 0!==r?r:1,presetFileName:d.presetFileName||""};f.writeVersionAndDescriptor(e,"","null",desc)}else if("curves"===d.type){desc={Vrsn:1,curvesPresetKind:null!==(n=d.presetKind)&&void 0!==n?n:1,curvesPresetFileName:d.presetFileName||""};f.writeVersionAndDescriptor(e,"","null",desc)}else if("channel mixer"===d.type){desc={Vrsn:1,mixerPresetKind:null!==(o=d.presetKind)&&void 0!==o?o:1,mixerPresetFileName:d.presetFileName||""};f.writeVersionAndDescriptor(e,"","null",desc)}else{if("brightness/contrast"!==d.type)throw new Error("Unhandled CgEd case");desc={Vrsn:1,Brgh:d.brightness||0,Cntr:d.contrast||0,means:null!==(l=d.meanValue)&&void 0!==l?l:127,"Lab ":!!d.labColorOnly,useLegacy:!!d.useLegacy,Auto:!!d.auto};f.writeVersionAndDescriptor(e,"","null",desc)}})),h("Txt2",k("engineData"),(function(e,t,r){var data=c.readBytes(e,r());t.engineData=o.fromByteArray(data)}),(function(e,t){var r=o.toByteArray(t.engineData);v.writeBytes(e,r)})),h("FMsk",k("filterMask"),(function(e,t){t.filterMask={colorSpace:c.readColor(e),opacity:c.readUint16(e)/255}}),(function(e,t){var r;v.writeColor(e,t.filterMask.colorSpace),v.writeUint16(e,255*d.clamp(null!==(r=t.filterMask.opacity)&&void 0!==r?r:1,0,1))})),h("artd",(function(e){return void 0!==e.artboards}),(function(e,t,r){var desc=f.readVersionAndDescriptor(e);t.artboards={count:desc["Cnt "],autoExpandOffset:{horizontal:desc.autoExpandOffset.Hrzn,vertical:desc.autoExpandOffset.Vrtc},origin:{horizontal:desc.origin.Hrzn,vertical:desc.origin.Vrtc},autoExpandEnabled:desc.autoExpandEnabled,autoNestEnabled:desc.autoNestEnabled,autoPositionEnabled:desc.autoPositionEnabled,shrinkwrapOnSaveEnabled:desc.shrinkwrapOnSaveEnabled,docDefaultNewArtboardBackgroundColor:ce(desc.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:desc.docDefaultNewArtboardBackgroundType},c.skipBytes(e,r())}),(function(e,t){var r,n,o,l,d,c=t.artboards,desc={"Cnt ":c.count,autoExpandOffset:c.autoExpandOffset?{Hrzn:c.autoExpandOffset.horizontal,Vrtc:c.autoExpandOffset.vertical}:{Hrzn:0,Vrtc:0},origin:c.origin?{Hrzn:c.origin.horizontal,Vrtc:c.origin.vertical}:{Hrzn:0,Vrtc:0},autoExpandEnabled:null===(r=c.autoExpandEnabled)||void 0===r||r,autoNestEnabled:null===(n=c.autoNestEnabled)||void 0===n||n,autoPositionEnabled:null===(o=c.autoPositionEnabled)||void 0===o||o,shrinkwrapOnSaveEnabled:null===(l=c.shrinkwrapOnSaveEnabled)||void 0===l||l,docDefaultNewArtboardBackgroundColor:ue(c.docDefaultNewArtboardBackgroundColor),docDefaultNewArtboardBackgroundType:null!==(d=c.docDefaultNewArtboardBackgroundType)&&void 0!==d?d:1};f.writeVersionAndDescriptor(e,"","null",desc,"artd")})),t.hasMultiEffects=te,h("lfx2",(function(e){return void 0!==e.effects&&!te(e.effects)}),(function(e,t,r,n,o){if(0!==c.readUint32(e))throw new Error("Invalid lfx2 version");var desc=f.readVersionAndDescriptor(e);t.effects=$(desc,!!o.logMissingFeatures),c.skipBytes(e,r())}),(function(e,t,r,n){var desc=ee(t.effects,!!n.logMissingFeatures,!1);v.writeUint32(e,0),f.writeVersionAndDescriptor(e,"","null",desc)})),h("cinf",k("compositorUsed"),(function(e,t,r){var desc=f.readVersionAndDescriptor(e);t.compositorUsed={description:desc.description,reason:desc.reason,engine:desc.Engn.split(".")[1],enableCompCore:desc.enableCompCore.split(".")[1],enableCompCoreGPU:desc.enableCompCoreGPU.split(".")[1],compCoreSupport:desc.compCoreSupport.split(".")[1],compCoreGPUSupport:desc.compCoreGPUSupport.split(".")[1]},c.skipBytes(e,r())}),(function(e,t){var r=t.compositorUsed,desc={Vrsn:{major:1,minor:0,fix:0},description:r.description,reason:r.reason,Engn:"Engn."+r.engine,enableCompCore:"enable."+r.enableCompCore,enableCompCoreGPU:"enable."+r.enableCompCoreGPU,compCoreSupport:"reason."+r.compCoreSupport,compCoreGPUSupport:"reason."+r.compCoreGPUSupport};f.writeVersionAndDescriptor(e,"","null",desc)})),h("extn",(function(e){return void 0!==e._extn}),(function(e,t){var desc=f.readVersionAndDescriptor(e);d.MOCK_HANDLERS&&(t._extn=desc)}),(function(e,t){d.MOCK_HANDLERS&&f.writeVersionAndDescriptor(e,"","null",t._extn)})),h("iOpa",k("fillOpacity"),(function(e,t){t.fillOpacity=c.readUint8(e)/255,c.skipBytes(e,3)}),(function(e,t){v.writeUint8(e,255*t.fillOpacity),v.writeZeros(e,3)})),h("tsly",k("transparencyShapesLayer"),(function(e,t){t.transparencyShapesLayer=!!c.readUint8(e),c.skipBytes(e,3)}),(function(e,t){v.writeUint8(e,t.transparencyShapesLayer?1:0),v.writeZeros(e,3)}))}}]);